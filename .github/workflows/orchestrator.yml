name: üß© OS Hardening Controller

on:
  workflow_dispatch:
    inputs:
      vendor:
        description: "amazonlinux | ubuntu | rhel | all"
        required: true
        default: "all"

concurrency:
  group: "controller-${{ github.ref }}"
  cancel-in-progress: false

# The reusable workflows do the heavy lifting; we keep this minimal.
permissions:
  contents: read

jobs:
  build-all:
    if: ${{ github.event.inputs.vendor == 'all' }}
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        vendor: [ubuntu, amazonlinux, rhel]
    steps:
      - name: ‚ñ∂Ô∏è Call vendor workflow - ${{ matrix.vendor }}
        uses: ./.github/workflows/build-${{ matrix.vendor }}.yml

  build-one:
    if: ${{ github.event.inputs.vendor != 'all' }}
    runs-on: ubuntu-latest
    steps:
      - name: ‚ñ∂Ô∏è Call vendor workflow - ${{ github.event.inputs.vendor }}
        uses: ./.github/workflows/build-${{ github.event.inputs.vendor }}.yml
